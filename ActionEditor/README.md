# ActionEditor 使用指南


## 一、简述

**ActionEditor** 是一款项目用的动效编辑器，其目标是将所有序列帧配置化，通过配置来实现统一所有序列帧的创建和播放。

**ActionEditor** 目前支持：

    1. 一键导出项目可用的序列帧配置。
    2· 可独立修改特定序列帧，可修改的属性包括：
        * 帧率
        * 缩放
        * 翻转
        * 是否开启混合
        * 混合源因子
        * 混合目标因子
    3. 更换地图，且地图可拖动，以方便策划查看。

**ActionEditor** 当前仅支持Windows平台。


## 二、目录结构

**ActionEditor** 的目录结构如下：

1. `README.md` : 即本说明文档。

2. `启动动效编辑器.bat` ：动效编辑器的启动入口，实际上此运行脚本包含了两个步骤，后续会说明。

3. `cocostudio` : UI界面目录（开发用）。

4. `res` : 资源目录，其中 `res/Textures` 用于放置所有序列帧资源。

5. `simulator` : 模拟器目录。

6. `src` : 编辑器源码目录，下面对几个重要的部分进行说明： 
    
    - `src/game/config/AnimationMap.lua` 是游戏最终需要的序列帧统一配置表。
    
    - `src/game/config/EditorConfig.lua` 是编辑器的配置表，主要保存编辑器的一些重要配置。
    
    - `src/game/config/EditorLoadItems.lua` 是由脚本自动生成的，它的作用是告诉编辑器有哪些序列帧可以使用。
    
    - `src/game/const` 目录下的所有 `Lua` 脚本是与 `res/Textures` 目录下的所有序列帧资源一一对应的帧数据配置，其记录了序列帧资源的每个动作和帧数；这个目录也是由脚本自动生成的，每次打开编辑器都会自动更新。
    
7. `tool` ： Python辅助脚本

    - `AnimationConstants.py` : 存放脚本所需的配置
    
    - `PlistParser.py` : 该脚本会解析 `res/Textures` 目录下的所有序列帧资源，并删掉 `plist` 文件中多余的部分以减小 `plist` 文件体积，同事生成 `src/game/const` 下的所有文件以及 `src/game/config/EditorLoadItems.lua`。


## 三、使用

1. 请确保所有序列帧资源存放在 `res/Textures/` 目录下，且资源为最新。

2. 双击运行 `启动动效编辑器.bat` 即可打开动效编辑器。

3. 编辑器提供了两个选项：

    - **导出配置** ： 导出游戏可用的序列帧配置，即：`src/game/config/AnimationMap.lua`

    - **开始编辑** : 加载所有序列帧资源后，进入编辑器，可对特定序列帧资源进行编辑

4. 编辑

    - 最左侧选项面板是一个可操作的序列帧归类，对应了 `res/Textures` 下的子目录。

    - 点击一个列表选项，可以看到可操作的所有序列帧。

    - 点击选择一个序列帧，在屏幕中央会播放一个序列帧动画对象，同时右上方动画列表中会加入该序列帧。

    - 屏幕上的动画选中后可以通过方向键来移动，此操作会修改动画的偏移值。

    - 可以通过点击屏幕上的动画对象或点击动画列表中的子项来切换当前操作的动画对象。

    - 当选中动画对象时，右下角会显示当前动画对象的帧数据，主要在此面板上进行帧数据的修改及保存。其中，帧率和缩放参数可以自行输入参数来修改，但需要点击右侧刷新按钮来应用，否则不会立即生效；同样的，修改之后，如果直接保存是不会生效的。

    - 左下角的地图列表可以进行地图的切换。

    - 右上角扩展了功能支持，如：

        - 清屏：移除当前屏幕上的所有帧动画对象

        - 全部暂停：暂停当前所有打开的帧动画对象

        - 全部开始：开始当前所有打开的帧动画对象

        - 全部保存：保存当前所有打开的帧动画对象

        - 动画列表：记录当前所有打开的帧动画对象

    - 点击动画列表的左侧的向下按钮，可以调整动画对象的显示层级，越往下层级越高；点击动画列表右侧的X按钮，可以将选择的动画对象从屏幕上移除。

    - 具体请自由探索。撸了三天，肩膀疼，写不动了~~~